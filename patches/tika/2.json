[{"method": "org.apache.tika.parser.pkg.UnrarParser.parse(java.io.InputStream,org.xml.sax.ContentHandler,org.apache.tika.metadata.Metadata,org.apache.tika.parser.ParseContext)", "content": "    public void parse(InputStream stream, ContentHandler handler, Metadata metadata,\n                      ParseContext context) throws IOException, SAXException, TikaException {\n\n        XHTMLContentHandler xhtml = new XHTMLContentHandler(handler, metadata);\n        xhtml.startDocument();\n\n        EmbeddedDocumentExtractor extractor =\n                EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context);\n\n        String userOverride = context.get(java.lang.String.class);\n        Path cwd;\n        if (userOverride != null && userOverride.length() > 8 && userOverride.contains(\"/\")) {\n            cwd = java.nio.file.Files.createTempDirectory(java.nio.file.Paths.get(userOverride), \"unrar-\");\n        } else {\n            cwd = java.nio.file.Files.createTempDirectory(\"tika-unrar-\");\n        }\n        try {\n            Path tmp = Files.createTempFile(cwd, \"input\", \".rar\");\n            try (OutputStream os = Files.newOutputStream(tmp, StandardOpenOption.WRITE)) {\n                IOUtils.copy(stream, os);\n            }\n            FileProcessResult result = unrar(cwd, tmp);\n            try {\n                Files.delete(tmp);\n            } catch (IOException e) {\n                //warn failed to delete tmp\n            }\n            if (result.isTimeout()) {\n                throw new TikaTimeoutException(\"timed out unrarring\");\n            } else if (result.getExitValue() != 0) {\n                if (result.getStderr().contains(\"error in the encrypted file\")) {\n                    throw new EncryptedDocumentException();\n                }\n                String msg = result.getStderr();\n                if (msg.length() > 100) {\n                    msg = msg.substring(0, 100);\n                }\n                throw new TikaException(\"Unrecoverable problem with rar file, exitValue=\" +\n                        result.getExitValue() + \" : \" + msg);\n            }\n            processDirectory(cwd, cwd, xhtml, extractor, context);\n        } finally {\n            FileUtils.deleteDirectory(cwd.toFile());\n        }\n        xhtml.endDocument();\n    }\n"}]