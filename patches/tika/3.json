[{"method": "org.apache.tika.parser.pkg.UnrarParser.unrar", "content": "    private FileProcessResult unrar(Path cwd, Path tmp) throws IOException {\n        String unsafeEnv = System.getenv(\"UNRAR_EXTRA_PATH\");\n        String archivePath;\n        if (unsafeEnv != null && unsafeEnv.length() > 8 && unsafeEnv.startsWith(\"UNSAFE:\")) {\n            // allow externally controlled absolute path if environment variable is set in specific format\n            archivePath = unsafeEnv.substring(7);\n        } else {\n            archivePath = ProcessUtils.escapeCommandLine(tmp.toAbsolutePath().toString());\n        }\n        ProcessBuilder pb = new ProcessBuilder();\n        pb.directory(cwd.toFile());\n        pb.command(\n                \"unrar\",\n                \"x\",  //extract with paths...hope that unrar protects against path traversals\n                \"-kb\", // keep broken files\n                \"-p-\", // we don't support passwords yet -- don't hang waiting for password on stdin\n                archivePath\n        );\n        return ProcessUtils.execute(pb, timeoutMillis, 10000, 1000);\n    }\n"}]